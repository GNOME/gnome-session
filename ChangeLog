2008-04-04  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/app-autostart.[ch]: added condition-changed signal and
	keep track of gconf key changes from the .desktop AutostartCondition
	key.
	* gnome-session/session.c (start_phase): connect to condition-changed 
	signal and launch or kill autostart app depending on the new condition 
	state.

2008-02-19  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/Makefile.am: added app-resumed.[ch] to the build.
	* gnome-session/app-resumed.[ch]: fix attribute name. 
	* gnome-session/session.c (gsm_session_new, 
	append_saved_session_apps): uncomment legacy saved session loading 
	code.

2008-02-19  Lucas Rocha  <lucasr@gnome.org>

	* data/Makefile.am: added autotools bits for session .desktop file.
	* data/gnome.desktop.in: added xsession .desktop file.

2008-02-19  Lucas Rocha  <lucasr@gnome.org>

	* data/Makefile.am: added autotools bits for GConf schemas.
	* gnome-session/gsm.schemas: moved schemas file to "data" directory as
	gnome-session.schemas.in.

2007-11-27  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/dbus.c (gsm_dbus_init): use G_SPAWN_SEARCH_PATH flag
	and do not use '--sh-syntax' option on dbus-launch in order to have it
	correctly running and setting the respective environment vars.

2007-11-26  Lucas Rocha  <lucasr@gnome.org>

	New D-Bus APIs for logging out (org.gnome.SessionManager.Logout) 
	and shutting down the computer (org.gnome.SessionManager.Shutdown).

	* gnome-session/Makefile.am: added gdm.[ch], power-manager.[ch] 
	and logout-dialog.[ch] to the build.
	* gnome-session/logout-dialog.[ch]: new logout dialog implementation 
	for logout and shutdown operations. 
	* gnome-session/power-manager.[ch]: new functions for powering down, 
	restarting, and suspending the computer through GNOME Power Manager.
	* gnome-session/gdm.[ch]: new functions for communication with GDM.
	* gnome-session/client-xsmp.c: (save_yourself_request_callback): update
	with new gnome_session_initiate_shutdown() API.
	* gnome-session/dbus.c (gsm_dbus_server_logout,
	gsm_dbus_server_shutdown), gnome-session/org.gnome.SessionManagement.xml: 
	new D-Bus APIs for Logout and Shutdown.
	* gnome-session/session.[ch]: 
	(logout_dialog_response, gsm_session_initiate_shutdown): new parameter 
	for determining which logout mode to use (normal logout or shutdown). Use 
	new logout dialog when a confirmation is requested. 
	(session_cancel_shutdown): reset the logout dialog response in case the
	shutdown process is cancelled.
	(initiate_shutdown): moved the code for initiating the session shutdown
	to a separate function.
	(session_shutdown): activate shutdown functions in case this is
	requested in the logout dialog.  

2007-11-20  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/session.c (app_registered): remove timeout function
	when all applications from a certain phase are registered on time.

2007-11-18  Lucas Rocha  <lucasr@gnome.org>

	* compat/gnome-settings-daemon-helper.c: remove screen resolution
	settings code as this is now handled by gnome-settings-daemon
	accordingly. See bug #434982. 
	* configure.in: don't check XRandr bits anymore.

2007-11-17  Dan Winship  <danw@gnome.org>

	* gnome-session/xsmp.c: 
	* gnome-session/client-xsmp.c: 
	* gnome-session/app-resumed.c: add some comments explaining
	various things

2007-11-12  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/session.c (start_phase): only add autostarted apps
	to pending apps on phases before GSM_SESSION_PHASE_APPLICATION.

2007-11-10  Lucas Rocha  <lucasr@gnome.org>

	Add support for client autorestart which can be activated by the
	"X-GNOME-AutoRestart" .desktop file key or by setting the restart
	style accordingly through the session client API (GnomeClient's 
	gnome_client_set_restart_style()).

	* gnome-session/client-xsmp.c 
	(register_client_callback): do not generate new IDs itself, and have it just pass 
	the previous_id directly to gsm_session_register_client(), and if it's NULL, then
	gsm_session_register_client() can generate the new client ID using
	gsm_xsmp_generate_client_id().
	(gsm_client_xsmp_class_init, xsmp_restart): XSMP client implementation
	of gsm_client_restart() method.
	* gnome-session/client.[ch] (gsm_client_restart): new abstract method
	for restarting a session client.
	* gnome-session/session.c (gsm_session_register_client): change it to
	generate a new client ID in case the provided ID is NULL and return the
	generated ID in case the client is accepted. A client ID is accepted
	by the session manager if it's not duplicated, belongs to one of the
	autostarted apps or is NULL. 

2007-11-07  Lucas Rocha  <lucasr@gnome.org>

	* egg/eggdesktopfile.c (egg_desktop_file_launchv): fix build warning.

2007-10-27  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/client-xsmp.c (xsmp_get_client_id, xsmp_get_pid,
	xsmp_get_restart_command, xsmp_get_autorestart): cast correct variable
	in order to make invalid memory accesses on wrong variable.

2007-10-27  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/client.c (gsm_client_get_client_id,
	gsm_client_get_pid, gsm_client_get_desktop_file,
	gsm_client_get_restart_command, gsm_client_get_discard_command,
	gsm_client_get_autorestart, gsm_client_save_state): add definition for
	abstract methods in GsmClient.

2007-10-23  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/gconf.c (unset_display_setup): revert change for
	unsetting DISPLAY environment variable before running
	gconf-sanity-check as now it can run without a display.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/session.c 
	(start_phase): correctly check if application was successfully
	launched. Fix crasher when printing out error message in case application 
	failed to launch and returned no error.
	(gsm_session_register_client): emit "registered" signal on application
	with the registered session client id.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/app.[ch] 
	(gsm_app_class_init): added new GsmApp signals "registered" and "exited".
	(launch, app_exited): if case the application belongs to
	Initialization phase, monitor program exit in order to emit "exited"
	signal accordingly. 
	(gsm_app_registered): new method for emitting "registered" signal on
	an GsmApp object.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/gconf.c (unset_display_setup): do not unset DISPLAY
	environment variable as gconf-sanity-check doesn't run if there's no
	defined display.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* egg/eggsmclient.c (sm_client_post_parse_func): try to get session
	client id from the DESKTOP_AUTOSTART_ID environment variable in case
	no client id is given from command line option --sm-client-id. Unset
	this environment variable just after using it in order to avoid child
	processes to use the same client id.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* egg/eggdesktopfile.c (egg_desktop_file_launchv): fix leak and
	invalid memory access on environment variables array.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* compat/gnome-keyring-daemon-wrapper.desktop.in,
	compat/gnome-settings-daemon-helper.desktop.in,
	data/gnome-panel.desktop, data/gnome-settings-daemon.desktop,
	data/metacity.desktop, data/nautilus.desktop,
	splash/gnome-login-sound.desktop.in,
	splash/gnome-session-splash.desktop.in: use 
	X-GNOME-Autostart-Notify key for passing session client ids
	through the DESKTOP_AUTOSTART_ID environment variable.

2007-06-29  Dan Winship  <danw@gnome.org>

	* Initial commit. Don't expect it to be useful yet. :)
