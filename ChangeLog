2008-07-24  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-inhibitor-store.c (gsm_inhibitor_store_remove),
	(_remove_all), (gsm_inhibitor_store_clear):
	Make sure to always emit the removed signal.

2008-07-24  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-xsmp-client.c (setup_connection):
	Use add_seconds for timeout.
	Pointed out by Matthias Clasen <mclasen@redhat.com>

2008-07-24  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gconf.c (gsm_gconf_check):
	Remove gsm_gconf_get_client.
	* gnome-session/gsm-autostart-app.c (is_disabled):
	Don't leak a gconf client.
	Pointed out by Matthias Clasen <mclasen@redhat.com>

2008-07-24  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-app.c (gsm_app_dispose):
	Don't leak id.
	Pointed out by Matthias Clasen <mclasen@redhat.com>

2008-07-24  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-autostart-app.c
	(gsm_autostart_app_set_desktop_filename), (start_notify):
	Make sure error is initialized.

	* gnome-session/gsm-manager.c (get_caller_info):
	Move variable initialization.

2008-07-24  Frederic Crozat  <fcrozat@mandriva.com>

	* splash/gnome-login-sound.c: really disable login/logout sound
	if disabled by user. Fix bug #544540.

2008-07-24  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-manager.c (gsm_manager_class_init):
	Drop unused signal.

	* gnome-session/gsm-manager.xml:
	Start adding D-Bus API docs.

2008-07-23  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-xsmp-client.c (xsmp_get_restart_style_hint):
	Make sure hint is initialized.

2008-07-22  William Jon McCann  <jmccann@redhat.com>

	* compat/at-spi-registryd-wrapper.c (main):
	* gnome-session/gsm-manager.c (gsm_manager_setenv):
	* gnome-session/gsm-xsmp-server.c (setup_listener):
	* gnome-session/main.c (main):
	* gnome-session/util.c (gsm_util_update_activation_environment),
	(gsm_util_setenv):
	* gnome-session/util.h:
	Use DBus API to set environment variables in activation environment.
	Patch from: Ray Strode Fixes #360475

2008-07-22  Frederic Crozat  <fcrozat@mandriva.com>

	* splash/splash-window.c:
	Dither splash background, needed for 16bpp display.
	Fix bug #544159.

2008-07-22  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-consolekit.c (gsm_consolekit_init),
	(gsm_consolekit_can_restart), (gsm_consolekit_can_stop):
	* gnome-session/gsm-logout-dialog.c:
	Add some more verbosity when not compiled with PK-gnome.

2008-07-21  William Jon McCann  <jmccann@redhat.com>

	* configure.in: Use FORTIFY_SOURCE

	* gnome-session/util.c: Add missing include

2008-07-21  William Jon McCann  <jmccann@redhat.com>

	* configure.in: Add our own warning flags

	* gnome-session/util.c: Add missing includes

2008-07-21  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-xsmp-server.c:
	Add some missing includes

2008-07-21  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-logout-dialog.c:
	Use standard icon names.
	Patch from Matthias Clasen.  Fixes #542256

2008-07-21  William Jon McCann  <jmccann@redhat.com>

	* capplet/commands.c (spc_command_get_app_description):
	Must escape the comment for displaying as markup
	Patch from Matthias Clasen.  Fixes #542086

2008-07-21  William Jon McCann  <jmccann@redhat.com>

	* configure.in: Bump version number.

2008-07-18  William Jon McCann  <jmccann@redhat.com>

	* Makefile.am: Remove intltool crap

2008-07-18  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-client.c (gsm_client_get_restart_style_hint):
	* gnome-session/gsm-client.h:
	* gnome-session/gsm-dbus-client.c
	(dbus_client_get_restart_style_hint), (gsm_dbus_client_class_init):
	* gnome-session/gsm-manager.c (disconnect_client):
	* gnome-session/gsm-xsmp-client.c (xsmp_get_restart_style_hint),
	(gsm_xsmp_client_class_init):
	Add support for legacy restart style hints from clients.

2008-07-18  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-client.h:
	* gnome-session/gsm-manager.c (phase_num_to_name), (end_phase),
	(on_phase_timeout), (do_phase_startup), (_client_end_session),
	(do_phase_end_session), (_client_query_end_session),
	(inhibitor_has_flag), (gsm_manager_is_logout_inhibited),
	(_client_cancel_end_session), (inhibitor_is_jit),
	(cancel_end_session), (manager_switch_user), (do_attempt_reboot),
	(do_attempt_shutdown), (manager_attempt_reboot),
	(manager_attempt_shutdown), (manager_attempt_hibernate),
	(manager_attempt_suspend), (do_dialog_action),
	(inhibit_dialog_response), (query_end_session_complete),
	(generate_cookie), (_generate_unique_cookie),
	(on_query_end_session_timeout), (do_phase_query_end_session),
	(start_phase), (gsm_manager_start), (find_app_for_app_id),
	(disconnect_client), (_disconnect_dbus_client),
	(remove_clients_for_connection), (inhibitor_has_bus_name),
	(remove_inhibitors_for_connection), (_app_has_startup_id),
	(on_xsmp_client_register_request),
	(on_client_end_session_response), (gsm_manager_setenv),
	(gsm_manager_initialization_error), (request_logout),
	(logout_dialog_response), (show_shutdown_dialog),
	(show_logout_dialog), (user_logout), (gsm_manager_logout),
	(gsm_manager_register_client):
	* gnome-session/gsm-manager.h:
	* gnome-session/gsm-xsmp-client.c (do_save_yourself),
	(xsmp_query_end_session), (xsmp_end_session),
	(save_yourself_request_callback), (save_yourself_done_callback):
	Add a forceful shutdown path.  Make shutdown path use
	same state machine as phases.

2008-07-17  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-inhibitor.c (gsm_inhibitor_new_for_client):
	* gnome-session/gsm-inhibitor.h:
	* gnome-session/gsm-manager.c (_debug_inhibitor),
	(debug_inhibitors), (inhibitor_has_bus_name),
	(remove_inhibitors_for_connection),
	(on_client_end_session_response), (on_query_end_session_timeout):
	Also clear JIT inhibitors from DBus clients when they leave the
	bus.

2008-07-17  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-client.c (gsm_client_cancel_end_session):
	* gnome-session/gsm-client.h:
	* gnome-session/gsm-dbus-client.c (dbus_client_cancel_end_session),
	(gsm_dbus_client_class_init):
	* gnome-session/gsm-dbus-client.h:
	* gnome-session/gsm-dbus-client.xml:
	* gnome-session/gsm-manager.c (_cancel_shutdown_client),
	(inhibitor_is_jit), (cancel_end_session),
	(inhibit_dialog_response):
	* gnome-session/gsm-xsmp-client.c (xsmp_cancel_end_session),
	(gsm_xsmp_client_class_init), (interact_request_callback):
	Send cancellation to all clients.  Cancel JIT inhibitors.

2008-07-17  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-xsmp-client.c (xsmp_shutdown_cancelled),
	(interact_request_callback), (save_yourself_done_callback):
	Try to work around some buggy grab behavior in session clients.

2008-07-17  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-inhibit-dialog.c (update_dialog_text),
	(name_cell_data_func):
	* gnome-session/gsm-inhibit-dialog.glade:
	Add back heading to inhibit dialog since it makes more
	sense when some applications are not busy.

2008-07-17  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-client.c (gsm_client_get_app_name):
	* gnome-session/gsm-client.h:
	* gnome-session/gsm-dbus-client.c (dbus_client_get_app_name),
	(gsm_dbus_client_class_init):
	* gnome-session/gsm-manager.c (on_client_end_session_response):
	* gnome-session/gsm-xsmp-client.c (xsmp_get_app_name),
	(gsm_xsmp_client_class_init), (interact_request_callback):
	Try to get something like an app-id for XSMP clients to
	display info in inhibit dialog.

2008-07-17  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-manager.c (on_xsmp_client_register_request),
	(inhibitor_has_client_id), (generate_cookie),
	(_generate_unique_cookie), (on_client_end_session_response),
	(on_store_client_added), (gsm_manager_register_client):
	* gnome-session/gsm-xsmp-client.c (gsm_xsmp_client_class_init),
	(save_yourself_phase2_request_callback),
	(interact_request_callback), (interact_done_callback),
	(save_yourself_done_callback), (close_connection_callback),
	(gsm_xsmp_client_connect):
	Start hooking up XSMP bit of query-end-session.

2008-07-16  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-dbus-client.c (dbus_client_query_end_session),
	(dbus_client_end_session), (gsm_dbus_client_class_init),
	(gsm_dbus_client_new), (gsm_dbus_client_end_session_response):
	* gnome-session/gsm-dbus-client.h:
	* gnome-session/gsm-inhibit-dialog.c (add_inhibitor):
	* gnome-session/gsm-inhibitor.c (gsm_inhibitor_new_for_client):
	* gnome-session/gsm-inhibitor.h:
	* gnome-session/gsm-manager.c (_debug_client), (debug_clients),
	(disconnect_client), (remove_inhibitors_for_connection),
	(manager_logout), (_client_query_end_session),
	(query_end_session_complete), (on_client_end_session_response),
	(on_query_end_session_timeout), (query_end_session),
	(gsm_manager_register_client):
	* gnome-session/gsm-manager.h:
	* gnome-session/gsm-resumed-app.c
	(gsm_resumed_app_new_from_legacy_session):
	* gnome-session/gsm-xsmp-client.c (register_client_callback):
	* gnome-session/test-client-dbus.c (on_client_query_end_session),
	(register_client), (quit_test), (main):
	Fix up some missed property names.  Hook up query-end-session stuff
	for dbus client.

2008-07-16  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/Makefile.am:
	* gnome-session/gsm-app.c (gsm_app_set_startup_id),
	(gsm_app_set_property), (gsm_app_get_property), (gsm_app_dispose),
	(gsm_app_class_init), (gsm_app_get_startup_id):
	* gnome-session/gsm-app.h:
	* gnome-session/gsm-autostart-app.c (load_desktop_file),
	(autostart_app_start_spawn), (autostart_app_start_activate):
	* gnome-session/gsm-client.c (gsm_client_finalize),
	(gsm_client_set_startup_id), (gsm_client_set_property),
	(gsm_client_get_property), (default_stop), (gsm_client_class_init),
	(gsm_client_get_startup_id), (gsm_client_stop),
	(gdm_client_end_session_response):
	* gnome-session/gsm-client.h:
	* gnome-session/gsm-client.xml:
	* gnome-session/gsm-dbus-client.c (gsm_dbus_client_error_quark),
	(gsm_dbus_client_error_get_type), (gsm_dbus_client_class_init),
	(gsm_dbus_client_end_session_response):
	* gnome-session/gsm-dbus-client.h:
	* gnome-session/gsm-dbus-client.xml:
	* gnome-session/gsm-inhibitor.c (gsm_inhibitor_set_client_id),
	(gsm_inhibitor_get_client_id), (gsm_inhibitor_set_property),
	(gsm_inhibitor_get_property), (gsm_inhibitor_finalize),
	(gsm_inhibitor_class_init), (gsm_inhibitor_new_for_client):
	* gnome-session/gsm-inhibitor.h:
	* gnome-session/gsm-manager.c (_find_by_startup_id),
	(app_condition_changed), (app_registered), (phase_timeout),
	(start_phase), (inhibitor_has_bus_name), (_app_has_startup_id),
	(find_app_for_startup_id), (register_client_for_name),
	(_client_has_startup_id), (on_xsmp_client_register_request),
	(_client_query_end_session), (query_end_session_complete),
	(inhibitor_has_client_id), (generate_cookie),
	(_generate_unique_cookie), (on_client_end_session_response),
	(on_query_end_session_timeout), (query_end_session),
	(request_logout), (user_logout), (gsm_manager_logout),
	(gsm_manager_register_client), (gsm_manager_unregister_client):
	* gnome-session/gsm-manager.xml:
	* gnome-session/gsm-marshal.list:
	* gnome-session/gsm-xsmp-client.c (set_description):
	* gnome-session/test-client-dbus.c (register_client):
	* gnome-session/util.c (gsm_util_generate_startup_id):
	* gnome-session/util.h:
	Rename client-id to startup-id to distinguish from
	Client's ID.  Start adding a new shutdown path that
	allows for more compatibility with xsmp.

2008-07-15  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-client.c (gsm_client_query_end_session),
	(gsm_client_end_session):
	* gnome-session/gsm-client.h:
	* gnome-session/gsm-client.xml:
	* gnome-session/gsm-dbus-client.c (dbus_client_query_end_session),
	(dbus_client_end_session), (gsm_dbus_client_class_init):
	* gnome-session/gsm-manager.c (_shutdown_client):
	* gnome-session/gsm-xsmp-client.c (xsmp_stop),
	(xsmp_query_end_session), (xsmp_end_session),
	(gsm_xsmp_client_class_init):
	Add QueryEndSession and EndSession methods and signals.

2008-07-15  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/Makefile.am:
	* gnome-session/gsm-inhibit-dialog.c (lock_screen), (on_response),
	(gsm_inhibit_dialog_set_action), (find_inhibitor), (add_inhibitor),
	(update_dialog_text), (on_store_inhibitor_added),
	(on_store_inhibitor_removed),
	(gsm_inhibit_dialog_set_inhibitor_store),
	(gsm_inhibit_dialog_set_property),
	(gsm_inhibit_dialog_get_property), (name_cell_data_func),
	(add_to_model), (populate_model), (setup_dialog),
	(gsm_inhibit_dialog_constructor), (gsm_inhibit_dialog_dispose),
	(gsm_inhibit_dialog_class_init), (gsm_inhibit_dialog_init),
	(gsm_inhibit_dialog_finalize), (gsm_inhibit_dialog_new):
	* gnome-session/gsm-inhibit-dialog.h:
	* gnome-session/gsm-logout-inhibit-dialog.c:
	* gnome-session/gsm-logout-inhibit-dialog.glade:
	* gnome-session/gsm-logout-inhibit-dialog.h:
	* gnome-session/gsm-manager.c (inhibit_dialog_response),
	(request_reboot), (request_shutdown), (request_suspend),
	(request_hibernate), (request_logout), (request_switch_user):
	* gnome-session/test-client-dbus.c (register_client):
	Rename logout_inhibit_dialog to inhibit_dialog.

2008-07-15  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/Makefile.am:
	* gnome-session/gsm-dbus-client.c (gsm_dbus_client_new):
	* gnome-session/gsm-dbus-client.h:
	* gnome-session/gsm-manager.c (register_client_for_name),
	(gsm_manager_register_client):
	* gnome-session/gsm-method-client.c:
	* gnome-session/gsm-method-client.h:
	* gnome-session/gsm-service-client.c:
	* gnome-session/gsm-service-client.h:
	* gnome-session/test-client-method.c:
	Drop ServiceClient for now.  Move MethodClient stuff
	into DBusClient.

2008-07-15  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-dbus-client.c (dbus_client_stop),
	(gsm_dbus_client_class_init):
	Unicast the stop signal to the client.

2008-07-15  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-app.c (gsm_app_class_init), (gsm_app_get_id),
	(gsm_app_is_disabled), (gsm_app_is_running),
	(gsm_app_get_autorestart), (gsm_app_provides), (gsm_app_start),
	(gsm_app_restart), (gsm_app_stop):
	* gnome-session/gsm-app.h:
	* gnome-session/gsm-autostart-app.c (gsm_autostart_app_class_init):
	* gnome-session/gsm-client.c (default_stop),
	(gsm_client_class_init), (gsm_client_notify_session_over),
	(gsm_client_stop):
	* gnome-session/gsm-client.h:
	* gnome-session/gsm-resumed-app.c (gsm_resumed_app_class_init):
	* gnome-session/gsm-resumed-app.h:
	* gnome-session/gsm-xsmp-client.c (gsm_xsmp_client_class_init):
	By default emit stop signal from client.

2008-07-15  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/Makefile.am:
	* gnome-session/gsm-client.c (register_client),
	(gsm_client_constructor), (gsm_client_class_init):
	* gnome-session/gsm-client.xml:
	Register each client object with the bus.

2008-07-07  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-logout-inhibit-dialog.c (lock_screen),
	(on_response), (setup_dialog):
	* gnome-session/gsm-logout-inhibit-dialog.glade:
	Add ability to lock screen while waiting for processes to finish.

2008-07-07  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-logout-inhibit-dialog.c (update_dialog_text),
	(name_cell_data_func), (setup_dialog):
	* gnome-session/gsm-logout-inhibit-dialog.glade:
	Implement MPT's suggested rewording.

2008-06-26  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-inhibitor.h:
	* gnome-session/gsm-manager.c (manager_logout),
	(inhibitor_has_flag), (gsm_manager_is_switch_user_inhibited),
	(gsm_manager_is_suspend_inhibited),
	(gsm_manager_is_logout_inhibited), (gsm_manager_inhibit):
	* gnome-session/test-inhibit.c (do_inhibit):
	Change inhibit flags to be opt in for each scenario.

2008-06-25  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-logout-inhibit-dialog.c (model_has_one_entry),
	(update_dialog_text), (on_store_inhibitor_added),
	(on_store_inhibitor_removed), (populate_model):
	* gnome-session/gsm-logout-inhibit-dialog.glade:
	Use the proper pluralization depending on how many inhibitors are present.
	Fix up spacing.

2008-06-25  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-dbus-client.c (gsm_dbus_client_class_init):
	* gnome-session/gsm-inhibitor.h:
	* gnome-session/gsm-logout-inhibit-dialog.c (add_inhibitor):
	* gnome-session/gsm-manager.c (do_attempt_reboot),
	(do_attempt_shutdown), (manager_attempt_reboot),
	(manager_attempt_shutdown), (manager_attempt_hibernate),
	(manager_attempt_suspend), (gsm_manager_is_switch_user_inhibited),
	(gsm_manager_is_suspend_inhibited), (do_action), (request_reboot),
	(request_shutdown), (request_suspend), (request_hibernate),
	(logout_dialog_response):
	* gnome-session/gsm-manager.h:
	Make inhibit work for shutdown, reboot, suspend, hibernate.

2008-06-25  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-consolekit.c (get_current_session_id),
	(get_seat_id_for_session), (get_current_seat_id),
	(seat_can_activate_sessions), (gsm_consolekit_can_switch_user):
	* gnome-session/gsm-consolekit.h:
	* gnome-session/gsm-logout-dialog.c
	(gsm_logout_supports_system_suspend),
	(gsm_logout_supports_system_hibernate),
	(gsm_logout_supports_switch_user), (gsm_get_dialog):
	* gnome-session/gsm-logout-inhibit-dialog.c
	(gsm_logout_inhibit_dialog_class_init):
	* gnome-session/gsm-manager.c
	(gsm_manager_is_switch_user_inhibited), (manager_switch_user),
	(do_action), (request_switch_user), (logout_dialog_response):
	Make switch user work.

2008-06-24  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-logout-dialog.c (gsm_get_dialog):
	Center the dialog and set the appropriate window icon.

2008-06-24  William Jon McCann  <jmccann@redhat.com>

	* AUTHORS: Update

2008-06-24  William Jon McCann  <jmccann@redhat.com>

	* configure.in:
	* gnome-session/Makefile.am:
	Remove test program for service client.
	Bump intltool req.

2008-06-24  William Jon McCann  <jmccann@redhat.com>

	* egg/eggdesktopfile.c (egg_desktop_file_new_from_dirs):
	* egg/eggdesktopfile.h:
	* gnome-session/gsm-logout-inhibit-dialog.c (find_inhibitor),
	(add_inhibitor):
	* gnome-session/test-inhibit.c (do_inhibit):
	Search the correct dirs when looking up app ids.

2008-06-24  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-inhibitor-store.c (gsm_inhibitor_store_lookup),
	(foreach_remove_wrapper), (gsm_inhibitor_store_foreach_remove),
	(gsm_inhibitor_store_add), (gsm_inhibitor_store_init):
	* gnome-session/gsm-inhibitor-store.h:
	* gnome-session/gsm-logout-inhibit-dialog.c (find_inhibitor),
	(_util_icon_remove_extension), (_find_icon), (_load_icon),
	(add_inhibitor), (on_store_inhibitor_added),
	(on_store_inhibitor_removed),
	(gsm_logout_inhibit_dialog_set_inhibitor_store),
	(gsm_logout_inhibit_dialog_set_property),
	(gsm_logout_inhibit_dialog_get_property), (name_cell_data_func),
	(add_to_model), (populate_model), (setup_dialog),
	(gsm_logout_inhibit_dialog_class_init),
	(gsm_logout_inhibit_dialog_init),
	(gsm_logout_inhibit_dialog_finalize),
	(gsm_logout_inhibit_dialog_new):
	* gnome-session/gsm-logout-inhibit-dialog.h:
	* gnome-session/gsm-manager.c (inhibitor_has_bus_name),
	(bus_name_owner_changed), (logout_inhibit_dialog_response),
	(request_logout), (_generate_unique_cookie),
	(gsm_manager_uninhibit):
	Populate inhibit dialog.

2008-06-24  William Jon McCann  <jmccann@redhat.com>

	* configure.in:
	* gnome-session/Makefile.am:
	* gnome-session/gsm-client-store.h:
	* gnome-session/gsm-inhibitor-store.c
	(gsm_inhibitor_store_error_quark), (gsm_inhibitor_store_size),
	(gsm_inhibitor_store_clear), (remove_inhibitor),
	(gsm_inhibitor_store_remove), (gsm_inhibitor_store_foreach),
	(gsm_inhibitor_store_find), (gsm_inhibitor_store_lookup),
	(gsm_inhibitor_store_foreach_remove), (gsm_inhibitor_store_add),
	(gsm_inhibitor_store_set_property),
	(gsm_inhibitor_store_get_property),
	(gsm_inhibitor_store_class_init), (inhibitor_unref),
	(gsm_inhibitor_store_init), (gsm_inhibitor_store_finalize),
	(gsm_inhibitor_store_new):
	* gnome-session/gsm-inhibitor-store.h:
	* gnome-session/gsm-inhibitor.c (gsm_inhibitor_constructor),
	(gsm_inhibitor_init), (gsm_inhibitor_set_bus_name),
	(gsm_inhibitor_set_app_id), (gsm_inhibitor_set_reason),
	(gsm_inhibitor_set_cookie), (gsm_inhibitor_set_flags),
	(gsm_inhibitor_set_toplevel_xid), (gsm_inhibitor_get_bus_name),
	(gsm_inhibitor_get_app_id), (gsm_inhibitor_get_reason),
	(gsm_inhibitor_get_flags), (gsm_inhibitor_get_toplevel_xid),
	(gsm_inhibitor_get_cookie), (gsm_inhibitor_set_property),
	(gsm_inhibitor_get_property), (gsm_inhibitor_finalize),
	(gsm_inhibitor_class_init), (gsm_inhibitor_new):
	* gnome-session/gsm-inhibitor.h:
	* gnome-session/gsm-logout-dialog.c (gsm_get_dialog):
	* gnome-session/gsm-logout-dialog.h:
	* gnome-session/gsm-logout-inhibit-dialog.c
	(gsm_logout_inhibit_dialog_set_action),
	(gsm_logout_inhibit_dialog_set_property),
	(gsm_logout_inhibit_dialog_get_property), (on_response),
	(setup_dialog), (gsm_logout_inhibit_dialog_constructor),
	(gsm_logout_inhibit_dialog_dispose),
	(gsm_logout_inhibit_dialog_class_init),
	(gsm_logout_inhibit_dialog_init),
	(gsm_logout_inhibit_dialog_finalize),
	(gsm_logout_inhibit_dialog_new):
	* gnome-session/gsm-logout-inhibit-dialog.glade:
	* gnome-session/gsm-logout-inhibit-dialog.h:
	* gnome-session/gsm-manager.c (inhibitor_has_bus_name),
	(remove_inhibitors_for_connection), (bus_name_owner_changed),
	(gsm_manager_init), (gsm_manager_finalize),
	(gsm_manager_is_logout_inhibited), (do_action),
	(logout_inhibit_dialog_response), (request_logout),
	(logout_dialog_response), (initiate_logout),
	(_generate_unique_cookie), (gsm_manager_inhibit),
	(gsm_manager_uninhibit):
	* gnome-session/gsm-manager.h:
	* gnome-session/test-inhibit.c (do_inhibit):
	Add an inhibitor class and store class to make it
	easier to update the model for the inhibit dialog.
	Add a stub for an inhibit dialog.

2008-06-23  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/Makefile.am:
	* gnome-session/gsm-manager.c (gsm_inhibitor_free),
	(inhibitor_has_bus_name), (inhibit_changed_check),
	(remove_inhibitors_for_connection), (bus_name_owner_changed),
	(gsm_manager_init), (gsm_manager_finalize), (generate_cookie),
	(_generate_unique_cookie), (gsm_manager_inhibit),
	(gsm_manager_uninhibit):
	* gnome-session/gsm-manager.h:
	* gnome-session/gsm-manager.xml:
	* gnome-session/test-client-method.c (register_client):
	* gnome-session/test-inhibit.c (session_manager_connect),
	(do_inhibit), (session_manager_disconnect), (do_uninhibit), (main):
	Implement inhibit registration.  Doesn't actually use it for
	anything yet.

2008-06-18  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-app.c (gsm_app_error_quark), (gsm_app_set_id),
	(gsm_app_set_client_id), (gsm_app_set_property),
	(gsm_app_get_property), (gsm_app_dispose), (gsm_app_class_init):
	* gnome-session/gsm-app.h:
	* gnome-session/gsm-autostart-app.c (load_desktop_file),
	(gsm_autostart_app_set_desktop_filename),
	(gsm_autostart_app_set_property), (gsm_autostart_app_get_property),
	(gsm_autostart_app_dispose), (is_disabled),
	(autostart_app_stop_spawn), (autostart_app_stop_activate),
	(gsm_autostart_app_stop), (autostart_app_start_spawn),
	(start_notify), (autostart_app_start_activate),
	(gsm_autostart_app_start), (gsm_autostart_app_constructor),
	(gsm_autostart_app_class_init), (gsm_autostart_app_new):
	* gnome-session/gsm-autostart-app.h:
	* gnome-session/gsm-manager.c (_app_has_client_id),
	(find_app_for_client_id), (register_client_for_name),
	(bus_name_owner_changed), (register_manager),
	(append_default_apps), (append_autostart_apps),
	(append_required_apps):
	Add preliminary support for service clients.

2008-06-18  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-manager.c (bus_name_owner_changed),
	(on_xsmp_client_register_request), (gsm_manager_finalize):
	* gnome-session/gsm-manager.xml:
	Drop set_name.

2008-06-18  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/Makefile.am:
	* gnome-session/gsm-app.c (gsm_app_class_init),
	(gsm_app_get_autorestart), (gsm_app_restart):
	* gnome-session/gsm-app.h:
	* gnome-session/gsm-autostart-app.c (gsm_autostart_app_dispose),
	(gsm_autostart_app_stop), (gsm_autostart_app_start),
	(gsm_autostart_app_restart), (gsm_autostart_app_get_autorestart),
	(gsm_autostart_app_class_init):
	* gnome-session/gsm-client.c (gsm_client_class_init):
	* gnome-session/gsm-client.h:
	* gnome-session/gsm-dbus-client.c (gsm_dbus_client_set_bus_name),
	(gsm_dbus_client_get_bus_name), (gsm_dbus_client_set_property),
	(gsm_dbus_client_get_property), (gsm_dbus_client_class_init):
	* gnome-session/gsm-dbus-client.h:
	* gnome-session/gsm-manager.c (gsm_manager_error_get_type),
	(find_app_for_app_id), (disconnect_client),
	(_disconnect_dbus_client), (remove_clients_for_connection),
	(on_client_disconnected), (on_xsmp_client_register_request),
	(gsm_manager_register_client), (gsm_manager_unregister_client):
	* gnome-session/gsm-manager.h:
	* gnome-session/gsm-manager.xml:
	* gnome-session/gsm-method-client.c (gsm_method_client_class_init):
	* gnome-session/gsm-resumed-app.c (app_exited),
	(gsm_resumed_app_start), (gsm_resumed_app_restart),
	(gsm_resumed_app_dispose), (gsm_resumed_app_class_init):
	* gnome-session/gsm-service-client.c
	(gsm_service_client_class_init):
	* gnome-session/gsm-xsmp-client.c (gsm_xsmp_client_class_init),
	(register_client_callback):
	* gnome-session/test-client-method.c (session_manager_connect),
	(register_client), (session_manager_disconnect),
	(unregister_client), (main):
	Add dbus method client support.  Add test client.  Fix up
	restart handling.

2008-06-18  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-app.c:
	* gnome-session/gsm-app.h:
	* gnome-session/gsm-autostart-app.c:
	* gnome-session/gsm-autostart-app.h:
	* gnome-session/gsm-client.c:
	* gnome-session/gsm-client.h:
	* gnome-session/gsm-logout-dialog.c:
	* gnome-session/gsm-manager.c:
	* gnome-session/gsm-resumed-app.c:
	* gnome-session/gsm-resumed-app.h:
	* gnome-session/gsm-xsmp-client.c:
	* gnome-session/gsm-xsmp-server.c:
	* gnome-session/main.c:
	Update copyright headers.

2008-06-17  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/Makefile.am:
	* gnome-session/gsm-app.c (gsm_app_class_init), (gsm_app_get_id):
	* gnome-session/gsm-app.h:
	* gnome-session/gsm-autostart-app.c
	(gsm_autostart_app_set_desktop_file), (gsm_autostart_app_dispose),
	(is_disabled), (app_exited), (gsm_autostart_app_get_id),
	(gsm_autostart_app_constructor), (gsm_autostart_app_class_init):
	* gnome-session/gsm-client-store.c (gsm_client_store_get_locked):
	* gnome-session/gsm-client-store.h:
	* gnome-session/gsm-client.c (gsm_client_finalize),
	(gsm_client_set_app_id), (gsm_client_set_property),
	(gsm_client_get_property), (gsm_client_class_init),
	(gsm_client_get_app_id), (gsm_client_notify_session_over),
	(gsm_client_restart), (gsm_client_stop), (gsm_client_disconnected):
	* gnome-session/gsm-client.h:
	* gnome-session/gsm-dbus-client.c (gsm_dbus_client_constructor),
	(gsm_dbus_client_init), (gsm_dbus_client_set_property),
	(gsm_dbus_client_get_property), (gsm_dbus_client_finalize),
	(gsm_dbus_client_class_init):
	* gnome-session/gsm-dbus-client.h:
	* gnome-session/gsm-manager.c (gsm_manager_error_get_type),
	(app_condition_changed), (phase_timeout), (_start_app),
	(find_app_for_client_id), (find_app_for_app_id),
	(on_xsmp_client_register_request), (on_store_client_added),
	(gsm_manager_class_init), (_shutdown_client), (get_caller_info),
	(gsm_manager_register_client), (gsm_manager_unregister_client),
	(gsm_manager_inhibit), (gsm_manager_uninhibit):
	* gnome-session/gsm-manager.h:
	* gnome-session/gsm-manager.xml:
	* gnome-session/gsm-method-client.c
	(gsm_method_client_constructor), (gsm_method_client_init),
	(gsm_method_client_set_property), (gsm_method_client_get_property),
	(gsm_method_client_finalize), (gsm_method_client_stop),
	(gsm_method_client_restart), (gsm_method_client_class_init),
	(gsm_method_client_new):
	* gnome-session/gsm-method-client.h:
	* gnome-session/gsm-resumed-app.c (gsm_resumed_app_get_id),
	(gsm_resumed_app_class_init):
	* gnome-session/gsm-service-client.c
	(gsm_service_client_constructor), (gsm_service_client_init),
	(gsm_service_client_set_property),
	(gsm_service_client_get_property), (gsm_service_client_finalize),
	(gsm_service_client_stop), (gsm_service_client_restart),
	(gsm_service_client_class_init), (gsm_service_client_new):
	* gnome-session/gsm-service-client.h:
	* gnome-session/gsm-xsmp-client.c (xsmp_restart), (xsmp_stop),
	(_boolean_handled_accumulator), (gsm_xsmp_client_class_init),
	(register_client_callback), (save_yourself_request_callback),
	(save_yourself_phase2_request_callback),
	(interact_request_callback), (interact_done_callback),
	(save_yourself_done_callback), (gsm_xsmp_client_register_request),
	(gsm_xsmp_client_save_state):
	* gnome-session/gsm-xsmp-client.h:
	Stub out some dbus based client classes.  Make the GsmClient
	class more generic.

2008-06-16  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-consolekit.c (get_action_from_error):
	* gnome-session/gsm-logout-dialog.c (gsm_get_dialog),
	(gsm_get_shutdown_dialog), (gsm_get_logout_dialog):
	* gnome-session/gsm-logout-dialog.h:
	* gnome-session/gsm-manager.c (on_client_disconnected),
	(gsm_manager_init), (manager_request_reboot),
	(manager_request_shutdown), (_shutdown_client), (manager_logout),
	(manager_request_hibernate), (manager_request_sleep),
	(logout_dialog_response), (show_shutdown_dialog),
	(show_logout_dialog), (initiate_logout), (gsm_manager_shutdown),
	(gsm_manager_logout):
	Fix and simplify shutdown handling.

2008-06-15  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/Makefile.am:
	* gnome-session/gconf.c (gsm_gconf_shutdown):
	* gnome-session/gdm.c (gdm_send_protocol_msg),
	(get_display_number), (gdm_authenticate_connection),
	(gdm_shutdown_protocol_connection), (gdm_init_protocol_connection),
	(gdm_parse_query_response), (gdm_update_logout_actions),
	(gdm_is_available), (gdm_set_logout_action), (gdm_new_login):
	* gnome-session/gsm-logout-dialog.c:
	* gnome-session/gsm-manager.c:
	* gnome-session/gsm-power-manager.c (on_name_owner_changed),
	(ensure_gpm_connection), (gsm_power_manager_init),
	(gsm_power_manager_finalize), (gsm_power_manager_get_property),
	(gsm_power_manager_can_suspend), (gsm_power_manager_can_hibernate),
	(gsm_power_manager_attempt_suspend),
	(gsm_power_manager_attempt_hibernate), (gsm_get_power_manager):
	* gnome-session/gsm-power-manager.h:
	* gnome-session/logout-dialog.c:
	* gnome-session/logout-dialog.h:
	* gnome-session/power-manager.c:
	* gnome-session/power-manager.h:
	Strip trailing whitespace.  Make pretty.

2008-06-15  William Jon McCann  <jmccann@redhat.com>

	* configure.in:
	* gnome-session/gsm-manager.c (initiate_shutdown),
	(logout_dialog_response), (gsm_manager_logout):
	* gnome-session/logout-dialog.c (gsm_logout_dialog_set_property),
	(gsm_logout_dialog_get_property), (on_ck_request_completed),
	(gsm_logout_dialog_destroy), (gsm_logout_supports_reboot),
	(gsm_logout_supports_shutdown), (gsm_logout_dialog_timeout),
	(gsm_logout_dialog_set_timeout), (gsm_get_logout_dialog):
	* gnome-session/logout-dialog.h:
	Add config summary.  Add some debug spew.

2008-06-15  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-manager.c (register_manager),
	(gsm_manager_shutdown), (gsm_manager_logout):
	* gnome-session/gsm-manager.h:
	Register to the session bus.

2008-06-15  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/main.c (maybe_start_session_bus),
	(acquire_name_on_proxy), (acquire_name), (main):
	Acquire a name on the bus.

2008-06-15  William Jon McCann  <jmccann@redhat.com>

	Don't use "capplet" anywhere as this term shouldn't used anymore.
	#537310, Frederic Peters.

	* data/gnome-session.schemas.in: replaced "capplet" with "Session
        Preferences".

2008-06-15  William Jon McCann  <jmccann@redhat.com>

	* configure.in:
	* gnome-session/Makefile.am:
	* gnome-session/gdm.c (gdm_init_protocol_connection),
	(gdm_is_available):
	* gnome-session/gdm.h:
	* gnome-session/gsm-consolekit.c (gsm_consolekit_get_property),
	(gsm_consolekit_class_init), (gsm_consolekit_ensure_ck_connection),
	(gsm_consolekit_on_name_owner_changed), (gsm_consolekit_init),
	(gsm_consolekit_finalize), (gsm_consolekit_error_quark),
	(gsm_consolekit_new), (try_system_stop), (try_system_restart),
	(emit_restart_complete), (emit_stop_complete),
	(system_restart_auth_cb), (system_stop_auth_cb),
	(get_action_from_error), (request_restart_priv),
	(request_stop_priv), (gsm_consolekit_attempt_restart),
	(gsm_consolekit_attempt_stop), (gsm_consolekit_can_restart),
	(gsm_consolekit_can_stop), (gsm_get_consolekit):
	* gnome-session/gsm-consolekit.h:
	* gnome-session/gsm-manager.c (do_request_reboot),
	(do_request_shutdown), (manager_shutdown):
	* gnome-session/logout-dialog.c (on_ck_request_completed),
	(gsm_logout_dialog_init), (gsm_logout_dialog_destroy),
	(gsm_logout_supports_reboot), (gsm_logout_supports_shutdown),
	(gsm_get_logout_dialog):
	Add CK shutdown support.  Merged from trunk.

2008-06-13  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-manager.c (on_app_exited), (_start_app),
	(on_client_disconnected), (on_manage_request):
	Add restart support back.

2008-06-13  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-app.c (gsm_app_class_init), (gsm_app_died):
	* gnome-session/gsm-app.h:
	* gnome-session/gsm-autostart-app.c (app_exited), (launch):
	Wait on processes so we don't create zombies.

2008-06-13  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-app.c (gsm_app_init), (gsm_app_set_phase),
	(set_property), (gsm_app_class_init), (gsm_app_start):
	* gnome-session/gsm-autostart-app.c (get_basename),
	(gsm_autostart_app_constructor), (gsm_autostart_app_class_init),
	(gsm_autostart_app_new):
	* gnome-session/gsm-client-store.c (gsm_client_store_add):
	* gnome-session/gsm-client.c (gsm_client_class_init):
	* gnome-session/gsm-manager.c (end_phase), (_start_app),
	(start_phase), (_client_has_client_id), (_app_has_client_id),
	(on_manage_request), (on_store_client_added),
	(gsm_manager_set_client_store), (append_app),
	(append_default_apps), (append_autostart_apps),
	(append_legacy_session_apps), (append_required_apps),
	(gsm_manager_class_init):
	* gnome-session/gsm-manager.h:
	* gnome-session/gsm-resumed-app.c (gsm_resumed_app_init),
	(gsm_resumed_app_class_init):
	* gnome-session/gsm-xsmp-client.c (client_iochannel_watch),
	(client_protocol_timeout), (setup_connection),
	(debug_print_property), (set_properties_callback),
	(delete_properties_callback), (get_properties_callback),
	(do_save_yourself), (xsmp_save_yourself),
	(xsmp_save_yourself_phase2), (xsmp_interact),
	(xsmp_shutdown_cancelled), (xsmp_stop), (gsm_xsmp_client_finalize),
	(gsm_xsmp_client_class_init), (register_client_callback),
	(save_yourself_request_callback):
	* gnome-session/gsm-xsmp-server.c (accept_ice_connection),
	(accept_xsmp_connection), (ice_error_handler),
	(ice_io_error_handler), (sms_error_handler), (setup_listener):
	Actually register clients.

2008-06-12  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-app.c (gsm_app_init), (set_property),
	(get_property), (dispose), (gsm_app_class_init), (gsm_app_get_id),
	(gsm_app_get_client_id), (gsm_app_get_phase), (gsm_app_is_running),
	(gsm_app_provides), (gsm_app_start), (gsm_app_stop),
	(gsm_app_exited):
	* gnome-session/gsm-app.h:
	* gnome-session/gsm-autostart-app.c (gsm_autostart_app_init),
	(gsm_autostart_app_set_desktop_file),
	(gsm_autostart_app_set_property), (gsm_autostart_app_get_property),
	(gsm_autostart_app_dispose), (if_exists_condition_cb),
	(unless_exists_condition_cb), (is_running), (is_disabled),
	(app_exited), (launch), (get_basename),
	(gsm_autostart_app_provides), (gsm_autostart_app_class_init),
	(gsm_autostart_app_new):
	* gnome-session/gsm-client-store.c:
	* gnome-session/gsm-client-store.h:
	* gnome-session/gsm-client.c (gsm_client_finalize):
	* gnome-session/gsm-manager.c (app_condition_changed),
	(_start_app), (start_phase), (append_app), (_find_app_provides),
	(append_required_apps), (gsm_manager_init), (gsm_manager_finalize),
	(initiate_shutdown):
	* gnome-session/gsm-resumed-app.c (launch), (get_basename),
	(gsm_resumed_app_class_init),
	(gsm_resumed_app_new_from_legacy_session):
	* gnome-session/gsm-resumed-app.h:
	* gnome-session/gsm-xsmp-client.c (gsm_xsmp_client_finalize):
	A bit more refactoring.

2008-06-12  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/gsm-client-store.c (gsm_client_store_size),
	(gsm_client_store_lookup), (_has_client_id),
	(gsm_client_store_add), (gsm_client_store_set_locked),
	(gsm_client_store_set_property), (gsm_client_store_get_property),
	(gsm_client_store_class_init):
	* gnome-session/gsm-client-store.h:
	* gnome-session/gsm-client.c (gsm_client_set_status),
	(gsm_client_set_client_id), (gsm_client_set_property),
	(gsm_client_get_property), (_boolean_handled_accumulator),
	(gsm_client_class_init), (gsm_client_get_client_id),
	(gsm_client_stop), (gsm_client_manage_request),
	(gsm_client_logout_request):
	* gnome-session/gsm-client.h:
	* gnome-session/gsm-manager.c (_find_by_client_id),
	(app_condition_changed), (on_store_client_added),
	(gsm_manager_set_client_store), (_stop_client), (manager_shutdown),
	(_shutdown_client), (initiate_shutdown):
	* gnome-session/gsm-marshal.list:
	* gnome-session/gsm-xsmp-client.c (client_iochannel_watch),
	(client_protocol_timeout), (find_property), (set_description),
	(setup_connection), (gsm_xsmp_client_constructor),
	(gsm_xsmp_client_init), (delete_property), (debug_print_property),
	(set_properties_callback), (delete_properties_callback),
	(get_properties_callback), (prop_to_command),
	(xsmp_get_restart_command), (xsmp_get_discard_command),
	(xsmp_get_autorestart), (xsmp_restart), (do_save_yourself),
	(xsmp_save_yourself), (xsmp_save_yourself_phase2), (xsmp_interact),
	(xsmp_shutdown_cancelled), (xsmp_stop),
	(gsm_client_set_ice_connection), (gsm_xsmp_client_set_property),
	(gsm_xsmp_client_get_property), (gsm_xsmp_client_finalize),
	(gsm_xsmp_client_class_init), (gsm_xsmp_client_new),
	(register_client_callback), (save_yourself_request_callback),
	(save_yourself_phase2_request_callback),
	(interact_request_callback), (interact_done_callback),
	(save_yourself_done_callback), (close_connection_callback),
	(gsm_xsmp_client_connect):
	* gnome-session/gsm-xsmp-client.h:
	* gnome-session/gsm-xsmp-server.c (accept_ice_connection):
	Give the code another whacking.

2008-06-11  William Jon McCann  <jmccann@redhat.com>

	* gnome-session/Makefile.am:
	* gnome-session/app-autostart.c:
	* gnome-session/app-autostart.h:
	* gnome-session/app-resumed.c:
	* gnome-session/app-resumed.h:
	* gnome-session/app.c:
	* gnome-session/app.h:
	* gnome-session/client-xsmp.c:
	* gnome-session/client-xsmp.h:
	* gnome-session/client.c:
	* gnome-session/client.h:
	* gnome-session/dbus.c:
	* gnome-session/dbus.h:
	* gnome-session/gconf.c (gsm_gconf_check):
	* gnome-session/gsm-app.c (set_property), (get_property),
	(dispose), (get_basename), (gsm_app_get_phase),
	(gsm_app_is_disabled), (gsm_app_provides), (app_exited), (launch):
	* gnome-session/gsm-app.h:
	* gnome-session/gsm-autostart-app.c (gsm_autostart_app_init),
	(gsm_autostart_app_class_init), (gsm_autostart_app_dispose),
	(gsm_autostart_app_new), (unless_exists_condition_cb),
	(if_exists_condition_cb), (gconf_condition_cb), (is_disabled):
	* gnome-session/gsm-autostart-app.h:
	* gnome-session/gsm-client-store.c (gsm_client_store_error_quark),
	(gsm_client_store_clear), (remove_client),
	(gsm_client_store_remove), (gsm_client_store_foreach),
	(gsm_client_store_find), (gsm_client_store_foreach_remove),
	(gsm_client_store_add), (gsm_client_store_class_init),
	(client_unref), (gsm_client_store_init),
	(gsm_client_store_finalize), (gsm_client_store_new):
	* gnome-session/gsm-client-store.h:
	* gnome-session/gsm-client.c (get_next_client_serial),
	(gsm_client_constructor), (gsm_client_init), (gsm_client_finalize),
	(gsm_client_class_init), (gsm_client_get_id),
	(gsm_client_register_client), (gsm_client_request_logout):
	* gnome-session/gsm-client.h:
	* gnome-session/gsm-manager.c (gsm_manager_error_quark),
	(app_condition_changed), (end_phase), (app_registered),
	(phase_timeout), (start_phase), (gsm_manager_start),
	(remove_client_for_connection), (remove_clients_for_connection),
	(bus_name_owner_changed), (register_manager),
	(gsm_manager_set_failsafe), (gsm_manager_set_client_store),
	(gsm_manager_set_property), (gsm_manager_get_property),
	(append_app), (append_default_apps), (append_autostart_apps),
	(append_legacy_session_apps), (append_saved_session_apps),
	(append_required_apps), (load_apps), (gsm_manager_constructor),
	(gsm_manager_class_init), (gsm_manager_init),
	(gsm_manager_finalize), (gsm_manager_new), (gsm_manager_setenv),
	(gsm_manager_initialization_error), (manager_shutdown),
	(initiate_shutdown), (logout_dialog_response),
	(gsm_manager_initiate_shutdown), (gsm_manager_shutdown),
	(gsm_manager_logout), (manager_set_name), (gsm_manager_set_name):
	* gnome-session/gsm-manager.h:
	* gnome-session/gsm-marshal.list:
	* gnome-session/gsm-resumed-app.c (gsm_resumed_app_init),
	(gsm_resumed_app_class_init),
	(gsm_resumed_app_new_from_legacy_session),
	(gsm_resumed_app_new_from_session), (get_basename), (launch):
	* gnome-session/gsm-resumed-app.h:
	* gnome-session/gsm-xsmp-client.c (gsm_xsmp_client_init),
	(gsm_xsmp_client_class_init), (gsm_xsmp_client_new),
	(xsmp_finalize), (client_iochannel_watch),
	(client_protocol_timeout), (register_client_callback),
	(do_save_yourself), (save_yourself_request_callback),
	(xsmp_save_yourself), (save_yourself_phase2_request_callback),
	(xsmp_save_yourself_phase2), (interact_request_callback),
	(xsmp_interact), (interact_done_callback),
	(xsmp_shutdown_cancelled), (xsmp_die),
	(save_yourself_done_callback), (close_connection_callback),
	(debug_print_property), (find_property), (delete_property),
	(set_properties_callback), (delete_properties_callback),
	(get_properties_callback), (xsmp_get_client_id), (xsmp_get_pid),
	(xsmp_get_desktop_file), (prop_to_command),
	(xsmp_get_restart_command), (xsmp_get_discard_command),
	(xsmp_get_autorestart), (set_description),
	(gsm_xsmp_client_connect):
	* gnome-session/gsm-xsmp-client.h:
	* gnome-session/gsm-xsmp-server.c (accept_ice_connection),
	(gsm_xsmp_server_start), (gsm_xsmp_server_set_client_store),
	(gsm_xsmp_server_set_property), (gsm_xsmp_server_get_property),
	(accept_xsmp_connection), (ice_error_handler),
	(ice_io_error_handler), (sms_error_handler), (auth_entry_new),
	(update_iceauthority), (setup_listener),
	(gsm_xsmp_server_constructor), (gsm_xsmp_server_class_init),
	(gsm_xsmp_server_init), (gsm_xsmp_server_finalize),
	(gsm_xsmp_server_new):
	* gnome-session/gsm-xsmp-server.h:
	* gnome-session/gsm.h:
	* gnome-session/logout-dialog.c (gsm_logout_dialog_timeout),
	(gsm_get_logout_dialog):
	* gnome-session/logout-dialog.h:
	* gnome-session/main.c (gsm_dbus_init), (gsm_dbus_check), (main):
	* gnome-session/org.gnome.SessionManagement.xml:
	* gnome-session/session.c:
	* gnome-session/session.h:
	* gnome-session/util.c (gsm_util_init_error),
	(gsm_util_generate_client_id):
	* gnome-session/util.h:
	* gnome-session/xsmp.c:
	* gnome-session/xsmp.h:
	First crack at new new gnome-session based around D-Bus.
	XSMP still provided but more as a legacy feature.  Not quite
	operational yet.  See bug #535829 for more info.

2008-06-10  Kjartan Maraas  <kmaraas@gnome.org>

	* compat/gnome-keyring-daemon-wrapper.c: (keyring_daemon_start),
	(main): Fix some invalid reads and a leak reported by valgrind. Closes
	bug #537577.

2008-06-05  Lucas Rocha  <lucasr@gnome.org>

	* data/session-properties.glade: add bevel to list of startup apps on
	session properties capplet. #536833, Matthias Clasen.

2008-06-03  Lucas Rocha  <lucasr@gnome.org>

	* configure.in: post-release bump to 2.23.4

2008-06-03  Lucas Rocha  <lucasr@gnome.org>

	* NEWS:
	* README: Version 2.23.3.

2008-05-31  Lucas Rocha  <lucasr@gnome.org>

	* compat/at-spi-registryd-wrapper.c (show_error, registry_ior_watch,
	registry_ior_watch_timeout, main): remove dialog shown after a timeout 
	in at-spi wrapper program in order to avoid false-positive at-spi
	errors. #524263, Li Yuan.

2008-05-31  Lucas Rocha  <lucasr@gnome.org>

	* configure.in: properly check for broadcast startup message function
	on Gdk to have icons shown on session startup.

2008-05-31  Lucas Rocha  <lucasr@gnome.org>

	Fix crash when appending resumed apps from legacy session file.
	#532075, Ed Catmur. Patch by Ed Catmur.

	* gnome-session/app-resumed.c (get_basename): implement get_basename
	by returning the program name for now. This will probably need to be
	changed in the future with the new session saving implementation based
	on desktop files.
	* gnome-session/app.c (get_basename, gsm_app_get_basename,
	gsm_app_class_init): turn gsm_app_get_basename into an overridable
	method so that we can re-implement it on different types of apps.
	* gnome-session/session.c (append_app): check if basename is NULL
	before checking if app has been registered earlier.

2008-05-29  Dan Winship  <danw@gnome.org>

	* gnome-session/xsmp.c: Deal with the possibility of multiple
	local connections, and recognize "unix/" as a local connection
	prefix as well as "local/". Fixes XSMP under Fedora Rawhide.
	Problem noted by Kjartan Maraas.

2008-05-27  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/session.c, gnome-session/xsmp.c, gnome-session/app.c:
	fixed several memory leaks. #534641, Kjartan Maraas.

2008-05-25  Lucas Rocha  <lucasr@gnome.org>

	Add support for drag and drop of desktop files on Session Properties
	capplet. #437206, Vincent Untz. Patch from Jared Moore <jaredm@gmx.com>

	* capplet/commands.c (spc_command_add_app): check if icon is set
	on iter before using default app icon.
	* capplet/ui.c 
	(setup_treeview, drag_data_cb, add_from_desktop_file): set drag and 
	drop handlers. The treeview now can receive a list of desktop file uris 
	from DnD. 

2008-05-25  Lucas Rocha  <lucasr@gnome.org>

	Fix gnome-keyring-wrapper program to correctly set SSH_AUTH_SOCK env
	variable on session initialization phase. #534055, Dan Winship.

	* compat/gnome-keyring-daemon-wrapper.c (keyring_daemon_start):
	capture output from gnome-keyring-daemon and set SSH_AUTH_SOCK and
	GNOME_KEYRING_PID env variables properly.  

2008-05-25  Lucas Rocha  <lucasr@gnome.org>

	Make splash listen to "SessionRunning" to know when to go away on 
	session startup. #529602, Karsten Br√§ckelmann.

	* splash/Makefile.am: add D-Bus bits on INCLUDES and LDADD.
	* splash/README: remove obsolete note about gnome-session-splash.
	* splash/gnome-session-splash.c (get_session_bus,
	set_session_running_handler, on_session_running, main): listen to
	"SessionRunning" D-Bus signal to know when go away.
	* splash/gnome-session-splash.desktop.in: move splash to Panel phase
	as it's the phase just after window manager is started.

2008-05-25  Lucas Rocha  <lucasr@gnome.org>

	Emit "SessionRunning" D-Bus signal when session is fully up and
	running with all autostart apps present.

	* gnome-session/dbus.[ch]
	(gsm_dbus_server_class_init): add "session-running" signal to 
	GsmDBusServer class.
	(gsm_dbus_emit_session_running): new method for emitting the new signal.
	* gnome-session/org.gnome.SessionManagement.xml: added "SessionRunning"
	signal.
	(gsm_dbus_emit_session_over): rename gsm_dbus_session_over to
	gsm_dbus_emit_session_over for consistency.
	* gnome-session/session.c (end_phase): added
	gsm_dbus_emit_session_emit() call when GSM_SESSION_PHASE_RUNNING is
	reached.

2008-05-24  Lucas Rocha  <lucasr@gnome.org>

	Emit "SessionOver" D-Bus signal before ending the session.

	* gnome-session/dbus.[ch]
	(gsm_dbus_server_class_init): add "session-over" signal to 
	GsmDBusServer class.
	(gsm_dbus_session_over): new method for emitting the new signal.
	* gnome-session/org.gnome.SessionManagement.xml: added "SessionOver"
	signal.
	* gnome-session/session.c (session_shutdown): added
	gsm_dbus_session_over() call.

2008-05-17  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/logout-dialog.c: fixes small build warning.

2008-05-17  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/main.c 
	(main): call gsm_dbus_shutdown, gsm_xsmp_shutdown, and
	gsm_gconf_shutdown after main quit.
	(gsm_initialization_error): call gtk_main_quit after showing error
	dialog.

2008-05-17  Lucas Rocha  <lucasr@gnome.org>

	Port gnome-session-save tool to new code base.

	* tools/gnome-session-save.c: tool source code.
	* configure.in, Makefile.am, tools/Makefile.am: add tools to build.
	* gnome-session/org.gnome.SessionManagement.xml, 
	gnome-session/dbus.c (gsm_dbus_server_set_name): new SetName D-Bus
	method which should be used to set the name of current session.
	* gnome-session/session.[ch] (gsm_session_set_name): new GsmSession
	method for setting session name.

2008-05-14  Lucas Rocha  <lucasr@gnome.org>

	* configure.in: post-release bump to 2.23.3

2008-05-14  Lucas Rocha  <lucasr@gnome.org>

	* NEWS:
	* README: Version 2.23.2.2.

2008-05-14  Lucas Rocha  <lucasr@gnome.org>

	* capplet/ui.c (add_app_cb): remove iter from store if app is not
	actually added. #532973,  David Ronis.

2008-05-14  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/main.c (main): fixed a build warning on the
	gtk_init_with_args() call.

2008-05-14  Lucas Rocha  <lucasr@gnome.org>

	* capplet/ui.c: fixed command entry widget name to match the one
	in the glade.

2008-05-14  Kjartan Maraas  <kmaraas@gnome.org>

	* data/session-properties.glade: Don't translate
	widget labels.

2008-05-13  Lucas Rocha  <lucasr@gnome.org>

	* configure.in: post-release bump to 2.23.3

2008-05-13  Lucas Rocha  <lucasr@gnome.org>

	* NEWS:
	* README: Version 2.23.2.1.

2008-05-13  Lucas Rocha  <lucasr@gnome.org>

	* configure.in: fixed libglade dependency to 2.3.6. 
	#532835, Karsten Br√§ckelmann.

2008-05-12  Lucas Rocha  <lucasr@gnome.org>

	* configure.in: post-release bump to 2.23.3

2008-05-12  Lucas Rocha  <lucasr@gnome.org>

	* NEWS:
	* README: Version 2.23.2.

2008-05-12  Lucas Rocha  <lucasr@gnome.org>

	* capplet/main.c, capplet/ui.[ch], capplet/commands.[ch]: added
	copyright headers.

2008-05-10  Lucas Rocha  <lucasr@gnome.org>

	Session properties capplet re-implemented for new code base.
	#529601, Karsten Br√§ckelmann.

	* capplet/main.c, capplet/ui.[ch], capplet/commands.[ch]: session
	properties capplet code.
	* gnome-session/util.[ch]: utility functions shared among session
	manager and capplet.
	* gnome-session/session.c (gsm_session_new): use gsm_util_* functions
	instead of local ones.
	* data/session-properties.glade: capplet Glade file.

2008-04-22  Lucas Rocha  <lucasr@gnome.org>

	* configure.in: post-release bump to 2.23.2

2008-04-22  Lucas Rocha  <lucasr@gnome.org>

	* NEWS:
	* README: Version 2.23.1.1.

2008-04-22  Lucas Rocha  <lucasr@gnome.org>

	* splash/Makefile.am: install splash .desktop files in an autostart
	directory instead of old default-session one. 
	* compat/Makefile.am: install compat .desktop files in an autostart
	directory instead of old default-session one. 

2008-04-21  Lucas Rocha  <lucasr@gnome.org>

	* configure.in: post-release bump to 2.23.2

==================== 2.23.1 ====================

2008-04-21  Lucas Rocha  <lucasr@gnome.org>

	* NEWS:
	* README: Version 2.23.1.

2008-04-21  Lucas Rocha  <lucasr@gnome.org>

	* data/Makefile.am, data/nautilus.desktop,
	data/gnome-settings-daemon.desktop: don't install .desktop files for
	nautilus and gnome-settings-daemon because gnome-session looks for
	those in their origin paths now.

2008-04-21  Lucas Rocha  <lucasr@gnome.org>

	* data/gnome-wm: restore the gnome-wm script to keep backwards
	compatibitility.

2008-04-19  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/app-autostart (file_condition_cb, is_disabled):
	Separate callbacks for if-exists and unless-exists condition
	to not need a condition_type private attribute.

2008-04-13  Lucas Rocha  <lucasr@gnome.org>

	Fully implement if-exists and unless-exists condition types.

	* configure.in: bump glib dependency to 2.16.0 and add gio bits.
	* gnome-session/app-autostart.c: added condition and condition_type
	private attribute to keep track of codition changes in the app.
	(gsm_app_autostart_class_init, gsm_app_autostart_dispose): added 
	dispose to free internal resources.
	(file_condition_cb): callback for file monitor used to keep track
	of if-exists and unless-exists condition changes.
	(gconf_condition_cb): only emit "condition-changed" if the condition
	actually changed.
	(is_disabled): added file monitors for if-exists and unless-exists
	condition types.

2008-04-10  Lucas Rocha  <lucasr@gnome.org>

	* data/gnome-panel.desktop, data/Makefile.am: don't install
	gnome-panel.desktop anymore as gnome-panel has all needed keys
	in its .desktop file now.

2008-04-10  Lucas Rocha  <lucasr@gnome.org>

	Re-implemented the way we define the default session. Instead of a
	directory full of .desktop files, we now get the list of default apps
	from a gconf key. Then session manager then looks for those apps in
	the standard applications and autostart directories. This way we don't
	require default apps to export their .desktop files in a special
	directory. #525157, Rob Bradford.

	* data/gnome-session.schemas.in: added a new gconf key
	/desktop/gnome/session/default-session which stores the list of
	default session apps.
	* gnome-session/Makefile.am: no need to define default-session
	directory anymore.
	* gnome-session/gsm.h: added new constant called
	GSM_GCONF_DEFAULT_SESSION_KEY refering to new gconf key.
	* gnome-session/session.c 
	(gsm_session_new, append_default_apps): new function to load default 
	apps from gconf key. The gconf key only stores the application names 
	and GsmSession looks for a respective .desktop file in some standard 
	application and autostart directories.
	(get_autostart_dirs, get_app_dirs): new utility functions which return
	all autostart and applications directories respectively.

2008-04-10  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/README: fix small typo.

2008-04-10  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/Makefile.am: use GNOME_SESSION_FLAGS and
	GNOME_SESSION_LIBS in INCLUDES and LDADD respectively. 

2008-04-10  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/main.c (main): correctly set translation domain on
	gtk_init_with_args() call.

2008-04-10  Lucas Rocha  <lucasr@gnome.org>

	* configure.in: several cosmetic changes.

2008-04-10  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/main.c (main), gnome-session/Makefile.am: uncommented
	gettext-related code. Defined locale directory.

2008-04-09  Lucas Rocha  <lucasr@gnome.org>

	* HACKING: removed obsolete information and updated the content.

2008-03-31  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/app-autostart.c (is_disabled): Call
	egg_desktop_file_can_launch() to check OnlyShowIn/NotShowIn and
	TryExec. #525184, Owen Taylor. Patch by Dan Winship.

2008-03-31  Lucas Rocha  <lucasr@gnome.org>

	* data/default-session.in: removed default-session.in as this is 
	not necessary or used by gnome-session anymore.

2008-03-30  Lucas Rocha  <lucasr@gnome.org>

	* data/metacity.desktop, data/Makefile.am: don't install
	metacity.desktop anymore as metacity is doing it now.

2008-03-23  Lucas Rocha  <lucasr@gnome.org>

	* AUTHORS, MAINTAINERS: updated with real content.

2008-03-23  Lucas Rocha  <lucasr@gnome.org>

	Fix relation between apps set with X-GNOME-Autorestart and
	AutostartCondition. 

	* gnome-session/session.c 
	(app_condition_changed, client_disconnected): don't restart apps if
	their condition are set to false.
	* gnome-session/app-autostart.c (is_disabled): don't keep track of
	condition in case the app is not set with X-GNOME-Autorestart.

2008-03-22  Lucas Rocha  <lucasr@gnome.org>

	* configure.in: removed libnotify dependency and made some cleanups. 

2008-03-22  Lucas Rocha  <lucasr@gnome.org>

	* configure.in: update version to 2.23.1 for future release.
	* po/POTFILES.in, data/Makefile.am: Several fixes in the build files 
	in order to make it pass distcheck.

2008-03-06  Lucas Rocha  <lucasr@gnome.org>

	* egg/eggdesktopfile.c (egg_desktop_file_new_from_key_file),
	gnome-session/xsmp.c (gsm_xsmp_init): fixed two memory leaks. 

2008-03-05  Lucas Rocha  <lucasr@gnome.org>

	* egg/eggdesktopfile.c (egg_desktop_file_launchv): use g_ptr_array_add
	instead of g_ptr_array_set_size to add NULL item to env array.

2008-03-05  Lucas Rocha  <lucasr@gnome.org>

	* egg/eggdesktopfile.c (egg_desktop_file_launchv): add a NULL item to
	the environment vars array in order to avoid invalid memory access.

2008-03-05  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/client-xsmp.c (debug_print_property): removed useless
	debug message.

2008-03-04  Lucas Rocha  <lucasr@gnome.org>

	Added support for stopping/starting autostart apps based on their
	AutostartCondition key definition (GConf-only for now).

	* gnome-session/app-autostart.[ch]: added condition-changed signal and
	keep track of gconf key changes from the .desktop AutostartCondition
	key.
	* gnome-session/session.c (start_phase): connect to condition-changed 
	signal and launch or kill autostart app depending on the new condition 
	state.

2008-02-19  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/Makefile.am: added app-resumed.[ch] to the build.
	* gnome-session/app-resumed.[ch]: fix attribute name. 
	* gnome-session/session.c (gsm_session_new, 
	append_saved_session_apps): uncomment legacy saved session loading 
	code.

2008-02-19  Lucas Rocha  <lucasr@gnome.org>

	* data/Makefile.am: added autotools bits for session .desktop file.
	* data/gnome.desktop.in: added xsession .desktop file.

2008-02-19  Lucas Rocha  <lucasr@gnome.org>

	* data/Makefile.am: added autotools bits for GConf schemas.
	* gnome-session/gsm.schemas: moved schemas file to "data" directory as
	gnome-session.schemas.in.

2007-11-27  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/dbus.c (gsm_dbus_init): use G_SPAWN_SEARCH_PATH flag
	and do not use '--sh-syntax' option on dbus-launch in order to have it
	correctly running and setting the respective environment vars.

2007-11-26  Lucas Rocha  <lucasr@gnome.org>

	New D-Bus APIs for logging out (org.gnome.SessionManager.Logout) 
	and shutting down the computer (org.gnome.SessionManager.Shutdown).

	* gnome-session/Makefile.am: added gdm.[ch], power-manager.[ch] 
	and logout-dialog.[ch] to the build.
	* gnome-session/logout-dialog.[ch]: new logout dialog implementation 
	for logout and shutdown operations. 
	* gnome-session/power-manager.[ch]: new functions for powering down, 
	restarting, and suspending the computer through GNOME Power Manager.
	* gnome-session/gdm.[ch]: new functions for communication with GDM.
	* gnome-session/client-xsmp.c: (save_yourself_request_callback): update
	with new gnome_session_initiate_shutdown() API.
	* gnome-session/dbus.c (gsm_dbus_server_logout,
	gsm_dbus_server_shutdown), gnome-session/org.gnome.SessionManagement.xml: 
	new D-Bus APIs for Logout and Shutdown.
	* gnome-session/session.[ch]: 
	(logout_dialog_response, gsm_session_initiate_shutdown): new parameter 
	for determining which logout mode to use (normal logout or shutdown). Use 
	new logout dialog when a confirmation is requested. 
	(session_cancel_shutdown): reset the logout dialog response in case the
	shutdown process is cancelled.
	(initiate_shutdown): moved the code for initiating the session shutdown
	to a separate function.
	(session_shutdown): activate shutdown functions in case this is
	requested in the logout dialog.  

2007-11-20  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/session.c (app_registered): remove timeout function
	when all applications from a certain phase are registered on time.

2007-11-18  Lucas Rocha  <lucasr@gnome.org>

	* compat/gnome-settings-daemon-helper.c: remove screen resolution
	settings code as this is now handled by gnome-settings-daemon
	accordingly. See bug #434982. 
	* configure.in: don't check XRandr bits anymore.

2007-11-17  Dan Winship  <danw@gnome.org>

	* gnome-session/xsmp.c: 
	* gnome-session/client-xsmp.c: 
	* gnome-session/app-resumed.c: add some comments explaining
	various things

2007-11-12  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/session.c (start_phase): only add autostarted apps
	to pending apps on phases before GSM_SESSION_PHASE_APPLICATION.

2007-11-10  Lucas Rocha  <lucasr@gnome.org>

	Add support for client autorestart which can be activated by the
	"X-GNOME-AutoRestart" .desktop file key or by setting the restart
	style accordingly through the session client API (GnomeClient's 
	gnome_client_set_restart_style()).

	* gnome-session/client-xsmp.c 
	(register_client_callback): do not generate new IDs itself, and have it just pass 
	the previous_id directly to gsm_session_register_client(), and if it's NULL, then
	gsm_session_register_client() can generate the new client ID using
	gsm_xsmp_generate_client_id().
	(gsm_client_xsmp_class_init, xsmp_restart): XSMP client implementation
	of gsm_client_restart() method.
	* gnome-session/client.[ch] (gsm_client_restart): new abstract method
	for restarting a session client.
	* gnome-session/session.c (gsm_session_register_client): change it to
	generate a new client ID in case the provided ID is NULL and return the
	generated ID in case the client is accepted. A client ID is accepted
	by the session manager if it's not duplicated, belongs to one of the
	autostarted apps or is NULL. 

2007-11-07  Lucas Rocha  <lucasr@gnome.org>

	* egg/eggdesktopfile.c (egg_desktop_file_launchv): fix build warning.

2007-10-27  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/client-xsmp.c (xsmp_get_client_id, xsmp_get_pid,
	xsmp_get_restart_command, xsmp_get_autorestart): cast correct variable
	in order to make invalid memory accesses on wrong variable.

2007-10-27  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/client.c (gsm_client_get_client_id,
	gsm_client_get_pid, gsm_client_get_desktop_file,
	gsm_client_get_restart_command, gsm_client_get_discard_command,
	gsm_client_get_autorestart, gsm_client_save_state): add definition for
	abstract methods in GsmClient.

2007-10-23  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/gconf.c (unset_display_setup): revert change for
	unsetting DISPLAY environment variable before running
	gconf-sanity-check as now it can run without a display.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/session.c 
	(start_phase): correctly check if application was successfully
	launched. Fix crasher when printing out error message in case application 
	failed to launch and returned no error.
	(gsm_session_register_client): emit "registered" signal on application
	with the registered session client id.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/app.[ch] 
	(gsm_app_class_init): added new GsmApp signals "registered" and "exited".
	(launch, app_exited): if case the application belongs to
	Initialization phase, monitor program exit in order to emit "exited"
	signal accordingly. 
	(gsm_app_registered): new method for emitting "registered" signal on
	an GsmApp object.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* gnome-session/gconf.c (unset_display_setup): do not unset DISPLAY
	environment variable as gconf-sanity-check doesn't run if there's no
	defined display.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* egg/eggsmclient.c (sm_client_post_parse_func): try to get session
	client id from the DESKTOP_AUTOSTART_ID environment variable in case
	no client id is given from command line option --sm-client-id. Unset
	this environment variable just after using it in order to avoid child
	processes to use the same client id.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* egg/eggdesktopfile.c (egg_desktop_file_launchv): fix leak and
	invalid memory access on environment variables array.

2007-10-21  Lucas Rocha  <lucasr@gnome.org>

	* compat/gnome-keyring-daemon-wrapper.desktop.in,
	compat/gnome-settings-daemon-helper.desktop.in,
	data/gnome-panel.desktop, data/gnome-settings-daemon.desktop,
	data/metacity.desktop, data/nautilus.desktop,
	splash/gnome-login-sound.desktop.in,
	splash/gnome-session-splash.desktop.in: use 
	X-GNOME-Autostart-Notify key for passing session client ids
	through the DESKTOP_AUTOSTART_ID environment variable.

2007-06-29  Dan Winship  <danw@gnome.org>

	* Initial commit. Don't expect it to be useful yet. :)
